import{a as I,b as te}from"./index-c07632d9.js";import{_ as z,d as oe,a as N,u as ae}from"./useUsers-1a873407.js";import{d as O,j as i,c as d,l as C,k as L,m as c,e as w,z as G,S as se,p as a,q as p,t as x,s as R,A as B,F as M,v as H,O as r,ad as q,x as A,_ as W,r as S,w as ne,K as le,f as re,ae as ie,U as ce}from"./index-39e3e9e2.js";import{u as de}from"./useModal-f560d186.js";import"./utils-b2fc192b.js";const ue="/HNAT-2024-demo-public/project-preview.png",E=O({__name:"ProjectStatusBadge",props:{status:{type:String,required:!0}},setup(_){const f={"in progress":"primary",archived:"secondary",completed:"success",important:"warning"};return(m,v)=>{const l=i("VaBadge");return d(),C(l,{square:"",color:f[m.$props.status],text:m.$props.status.toUpperCase()},null,8,["color","text"])}}}),pe=p("img",{src:ue,class:"h-52"},null,-1),me={class:"text-[var(--va-secondary)]"},ge={class:"flex flex-col items-center gap-4 grow"},ve={class:"va-h4 text-center self-stretch overflow-hidden line-clamp-2 text-ellipsis"},_e=p("span",{class:"text-[var(--va-secondary)]"},"Owner: ",-1),fe={class:"flex justify-between"},be={key:1,class:"p-4 flex justify-center items-center text-[var(--va-secondary)]"},ye=O({__name:"ProjectCards",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0}},emits:["edit","delete","open"],setup(_){const f=m=>{const v=["primary","#FFD43A","#ADFF00","#262824","danger"],l=m.charCodeAt(0)%v.length;return v[l]};return(m,v)=>{const l=i("VaAvatarGroup"),h=i("VaDivider"),y=i("VaButton"),k=i("VaCardContent"),j=i("VaCard"),u=i("VaInnerLoading"),s=L("tooltip");return _.projects.length>0||_.loading?(d(),C(u,{key:0,loading:_.loading,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 min-h-[4rem]"},{default:c(()=>[(d(!0),w(M,null,G(_.projects,o=>(d(),C(j,{key:o.project_name,style:se({"--va-card-outlined-border":"1px solid var(--va-background-element)"}),outlined:""},{default:c(()=>[pe,a(k,{class:"flex flex-col h-full"},{default:c(()=>[p("div",me,x(o.creation_date),1),p("div",ge,[p("h4",ve,x(o.project_name),1),p("p",null,[_e,p("span",null,x(o.project_owner.fullname),1)]),a(l,{class:"my-4",options:o.team.map(t=>({label:t.fullname,src:t.avatar,fallbackText:t.fullname[0],color:f(t.fullname)})),max:5},null,8,["options"]),a(E,{status:o.status},null,8,["status"])]),a(h,{class:"my-6"}),p("div",fe,[R((d(),C(y,{preset:"primary",icon:"dashboard",color:"primary",onClick:t=>m.$emit("open",o)},{default:c(()=>[B("Open project")]),_:2},1032,["onClick"])),[[s,"Open project in dashboard"]])])]),_:2},1024)]),_:2},1032,["style"]))),128))]),_:1},8,["loading"])):(d(),w("div",be,"No projects"))}}}),je={class:"ellipsis max-w-[230px] lg:max-w-[450px]"},Ve={class:"flex items-center gap-2 ellipsis max-w-[230px]"},xe={class:"flex gap-2 justify-end"},we={class:"flex flex-col-reverse md:flex-row gap-2 justify-between items-center py-2"},ke={key:0,class:"flex"},Ce=O({__name:"ProjectsTable",props:{projects:{type:Array,required:!0},loading:{type:Boolean,required:!0},sortBy:{type:Object,required:!0},sortingOrder:{type:Object,required:!0},pagination:{type:Object,required:!0}},emits:["edit","delete","open"],setup(_,{emit:f}){const m=oe([{label:"Project name",key:"project_name",sortable:!0},{label:"Project owner",key:"project_owner",sortable:!0},{label:"Team",key:"team",sortable:!0},{label:"Status",key:"status",sortable:!0},{label:"Creation Date",key:"creation_date",sortable:!0},{label:" ",key:"actions"}]),v=_,l=f,h=u=>{const s=["primary","#FFD43A","#ADFF00","#262824","danger"],o=u.charCodeAt(0)%s.length;return s[o]},y=I(v,"sortBy",l),k=I(v,"sortingOrder",l),j=H(()=>Math.ceil(v.pagination.total/v.pagination.perPage));return(u,s)=>{const o=i("VaAvatarGroup"),t=i("VaButton"),$=i("VaDataTable"),P=i("VaSelect"),F=i("VaPagination"),U=L("tooltip");return d(),w("div",null,[a($,{"sort-by":r(y),"onUpdate:sortBy":s[0]||(s[0]=n=>q(y)?y.value=n:null),"sorting-order":r(k),"onUpdate:sortingOrder":s[1]||(s[1]=n=>q(k)?k.value=n:null),items:_.projects,columns:r(m),loading:_.loading},{"cell(project_name)":c(({rowData:n})=>[p("div",je,x(n.project_name),1)]),"cell(project_owner)":c(({rowData:n})=>[p("div",Ve,[a(z,{user:n.project_owner,size:"small"},null,8,["user"]),B(" "+x(n.project_owner.fullname),1)])]),"cell(team)":c(({rowData:n})=>[a(o,{size:"small",options:n.team.map(e=>({label:e.fullname,src:e.avatar,fallbackText:e.fullname[0],color:h(e.fullname)})),max:5},null,8,["options"])]),"cell(status)":c(({rowData:n})=>[a(E,{status:n.status},null,8,["status"])]),"cell(actions)":c(({rowData:n})=>[p("div",xe,[R((d(),C(t,{preset:"primary",size:"small",color:"primary",icon:"dashboard",onClick:e=>u.$emit("open",n)},{default:c(()=>[B("Open project")]),_:2},1032,["onClick"])),[[U,"Open project in dashboard"]])])]),_:1},8,["sort-by","sorting-order","items","columns","loading"]),p("div",we,[p("div",null,[p("b",null,x(u.$props.pagination.total)+" results.",1),B(" Results per page "),a(P,{modelValue:u.$props.pagination.perPage,"onUpdate:modelValue":s[2]||(s[2]=n=>u.$props.pagination.perPage=n),class:"!w-20",options:[10,50,100]},null,8,["modelValue"])]),j.value>1?(d(),w("div",ke,[a(t,{preset:"secondary",icon:"va-arrow-left","aria-label":"Previous page",disabled:u.$props.pagination.page===1,onClick:s[3]||(s[3]=n=>u.$props.pagination.page--)},null,8,["disabled"]),a(t,{class:"mr-2",preset:"secondary",icon:"va-arrow-right","aria-label":"Next page",disabled:u.$props.pagination.page===j.value,onClick:s[4]||(s[4]=n=>u.$props.pagination.page++)},null,8,["disabled"]),a(F,{modelValue:u.$props.pagination.page,"onUpdate:modelValue":s[5]||(s[5]=n=>u.$props.pagination.page=n),"buttons-preset":"secondary",pages:j.value,"visible-pages":5,"boundary-links":!1,"direction-links":!1},null,8,["modelValue","pages"])])):A("",!0)])])}}});const he=W(Ce,[["__scopeId","data-v-860dfef8"]]),$e={class:"flex justify-end flex-col-reverse sm:flex-row mt-4 gap-2"},Pe=O({__name:"EditProjectForm",props:{project:{},saveButtonLabel:{}},emits:["save","close"],setup(_,{expose:f}){const m=_,v={project_name:"",project_owner:void 0,team:[],status:void 0},l=S({...v}),h=H(()=>Object.keys(l.value).some(o=>{var t;return o==="team"?!1:l.value[o]!==((t=m.project??v)==null?void 0:t[o])}));f({isFormHasUnsavedChanges:h}),ne(()=>m.project,()=>{m.project&&(l.value={...m.project,project_owner:m.project.project_owner})},{immediate:!0});const y=o=>!!o||"This field is required",{users:k,filters:j}=N({pagination:S({page:1,perPage:100,total:10})}),{users:u,filters:s}=N({pagination:S({page:1,perPage:100,total:10})});return(o,t)=>{const $=i("VaInput"),P=i("VaSelect"),F=i("VaButton"),U=i("VaForm");return d(),C(U,{class:"flex flex-col gap-2"},{default:c(({validate:n})=>[a($,{modelValue:l.value.project_name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value.project_name=e),label:"Project name",rules:[y]},null,8,["modelValue","rules"]),a(P,{modelValue:l.value.project_owner,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.project_owner=e),search:r(s).search,"onUpdate:search":t[2]||(t[2]=e=>r(s).search=e),searchable:"",label:"Owner","text-by":"fullname","track-by":"id",rules:[y],options:r(u)},{content:c(({value:e})=>[e?(d(),w("div",{key:e.id,class:"flex items-center gap-1 mr-4"},[a(z,{user:e,size:"18px"},null,8,["user"]),B(" "+x(e.fullname),1)])):A("",!0)]),_:1},8,["modelValue","search","rules","options"]),a(P,{modelValue:l.value.team,"onUpdate:modelValue":t[3]||(t[3]=e=>l.value.team=e),search:r(j).search,"onUpdate:search":t[4]||(t[4]=e=>r(j).search=e),label:"Team","text-by":"fullname","track-by":"id",multiple:"",rules:[e=>"length"in e&&e.length>0||"This field is required"],options:r(k),"max-visible-options":o.$vaBreakpoint.mdUp?3:1},{content:c(({valueArray:e})=>[e?(d(!0),w(M,{key:0},G(e,(D,T)=>(d(),w("div",{key:D.id,class:"flex items-center gap-1 mr-2"},[a(z,{user:D,size:"18px"},null,8,["user"]),B(" "+x(D.fullname)+x(T<e.length-1?",":""),1)]))),128)):A("",!0)]),_:1},8,["modelValue","search","rules","options","max-visible-options"]),a(P,{modelValue:l.value.status,"onUpdate:modelValue":t[5]||(t[5]=e=>l.value.status=e),label:"Status",rules:[y],"track-by":"value","value-by":"value",options:[{text:"In progress",value:"in progress"},{text:"Archived",value:"archived"},{text:"Completed",value:"completed"},{text:"Important",value:"important"}]},{content:c(({value:e})=>[e?(d(),C(E,{key:0,status:e.value},null,8,["status"])):A("",!0)]),_:1},8,["modelValue","rules"]),p("div",$e,[a(F,{preset:"secondary",color:"secondary",onClick:t[6]||(t[6]=e=>o.$emit("close"))},{default:c(()=>[B("Cancel")]),_:1}),a(F,{onClick:e=>n()&&o.$emit("save",l.value)},{default:c(()=>[B(x(o.saveButtonLabel),1)]),_:2},1032,["onClick"])])]),_:1})}}});const Be=W(Pe,[["__scopeId","data-v-cc1c112b"]]),Fe=p("h1",{class:"page-title"},"Projects",-1),Ue={class:"flex flex-col md:flex-row gap-2 mb-2 justify-between"},De={class:"flex flex-col md:flex-row gap-2 justify-start"},Se={key:0,class:"va-h5 mb-4"},Oe={key:1,class:"va-h5 mb-4"},Ee=O({__name:"ProjectsPage",setup(_){const f=te("projects-view",!0),m=le(),v=re(),l=ie(),{projects:h,update:y,add:k,isLoading:j,remove:u,pagination:s,sorting:o}=ae(),t=S(null),$=S(!1),P=g=>{t.value=g,$.value=!0},F=g=>{m.currentProjectName=g.project_name,m.currentProjectIndex=g.id,v.currentDataset=g.id,l.push({name:"dashboard"})},{init:U}=ce(),n=async g=>{$.value=!1,"id"in g?(await y(g),U({message:"Project updated",color:"success"})):(await k(g),U({message:"Project created",color:"success"}))},{confirm:e}=de(),D=async g=>{await e({title:"Delete project",message:`Are you sure you want to delete project "${g.project_name}"?`,okText:"Delete",size:"small",maxWidth:"380px"})&&(await u(g),U({message:"Project deleted",color:"success"}))},T=S(),K=async g=>{T.value.isFormHasUnsavedChanges?await e({maxWidth:"380px",message:"Form has unsaved changes. Are you sure you want to close it?",size:"small"})&&g():g()};return(g,b)=>{const J=i("VaButtonToggle"),Q=i("VaCardContent"),X=i("VaModal"),Y=i("VaCard");return d(),w(M,null,[Fe,a(Y,null,{default:c(()=>[a(Q,null,{default:c(()=>[p("div",Ue,[p("div",De,[a(J,{modelValue:r(f),"onUpdate:modelValue":b[0]||(b[0]=V=>q(f)?f.value=V:null),color:"background-element","border-color":"background-element",options:[{label:"Cards",value:!0},{label:"Table",value:!1}]},null,8,["modelValue"])])]),r(f)?(d(),C(ye,{key:0,projects:r(h),loading:r(j),onEdit:P,onDelete:D,onOpen:F},null,8,["projects","loading"])):(d(),C(he,{key:1,"sort-by":r(o).sortBy,"onUpdate:sortBy":b[1]||(b[1]=V=>r(o).sortBy=V),"sorting-order":r(o).sortingOrder,"onUpdate:sortingOrder":b[2]||(b[2]=V=>r(o).sortingOrder=V),pagination:r(s),"onUpdate:pagination":b[3]||(b[3]=V=>q(s)?s.value=V:null),projects:r(h),loading:r(j),onEdit:P,onDelete:D,onOpen:F},null,8,["sort-by","sorting-order","pagination","projects","loading"]))]),_:1}),a(X,{modelValue:$.value,"onUpdate:modelValue":b[4]||(b[4]=V=>$.value=V),size:"small","mobile-fullscreen":"","close-button":"",stateful:"","hide-default-actions":"","before-cancel":K},{default:c(({cancel:V,ok:Z})=>[t.value===null?(d(),w("h1",Se,"Add project")):(d(),w("h1",Oe,"Edit project")),a(Be,{ref_key:"editFormRef",ref:T,project:t.value,"save-button-label":t.value===null?"Add":"Save",onClose:V,onSave:ee=>{n(ee),Z()}},null,8,["project","save-button-label","onClose","onSave"])]),_:1},8,["modelValue"])]),_:1})],64)}}});export{Ee as default};
//# sourceMappingURL=ProjectsPage-e34deb58.js.map
